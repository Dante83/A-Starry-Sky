<!DOCTYPE html>

<html>
  <head>

    <meta charset="UTF-8">
    <title>Verdant Valley</title>

    <!--Meta-->
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no,user-scalable=no,maximum-scale=1">

    <!-- Built for A-Frame -->
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script src="https://unpkg.com/aframe-fps-counter-component/dist/aframe-fps-counter-component.min.js"></script>
    <!--This commented out code is the unfurled stack which I use for debugging-->

    <!-- A-Starry-Sky Version 1.0 -->
    <!-- <script src="../dist/a-starry-sky.master.min.js"></script> -->

    <!-- Sky Interpolator -->
    <!-- <script src="../dist/wasm/interpolation-engine.js"></script> -->
    <script src="../src/cpp/interpolation-engine/interpolation-engine.js"></script>

    <!-- The below are used for development purposes, it is advised that you use the files in the dist folder -->
    <!-- Three.js extensions -->
    <script src="../src/js/three_js_extensions/BufferGeometryUtils.js"></script>
    <script src="../src/js/three_js_extensions/CopyShader.js"></script>
    <script src="../src/js/three_js_extensions/Pass.js"></script>
    <script src="../src/js/three_js_extensions/RenderPass.js"></script>
    <script src="../src/js/three_js_extensions/ShaderPass.js"></script>
    <script src="../src/js/three_js_extensions/EffectComposer.js"></script>
    <script src="../src/js/three_js_extensions/StarrySkyGPUComputeRenderer.js"></script>

    <!-- Post Processing -->
    <script src="../src/js/three_js_extensions/LuminosityHighPassShader.js"></script>
    <script src="../src/js/three_js_extensions/UnrealBloom.js"></script>

    <!-- Namespace -->
    <script src="../src/js/StarrySky.js"></script>

    <!-- Materials -->
    <script src="../src/js/materials/atmosphere/atmosphere-functions.js"></script>
    <script src="../src/js/materials/atmosphere/transmittance.js"></script>
    <script src="../src/js/materials/atmosphere/single-scattering.js"></script>
    <script src="../src/js/materials/atmosphere/inscattering-sum.js"></script>
    <script src="../src/js/materials/atmosphere/kth-inscattering.js"></script>
    <script src="../src/js/materials/atmosphere/atmosphere-pass.js"></script>
    <script src="../src/js/materials/postprocessing/moon-and-sun-output.js"></script>
    <script src="../src/js/materials/sun/base-sun-partial.js"></script>
    <script src="../src/js/materials/moon/base-moon-partial.js"></script>
    <script src="../src/js/materials/stars/star-data-map.js"></script>
    <script src="../src/js/materials/autoexposure/metering-survey.js"></script>
    <script src="../src/js/materials/clouds/cloud-noise.js"></script>
    <script src="../src/js/materials/fog/fog-pars.js"></script>
    <script src="../src/js/materials/fog/fog.js"></script>

    <!--- Custom HTML Tags -->
    <script src="../src/js/html_tags/HTMLTagUtils.js"></script>
    <script src="../src/js/html_tags/SkyAssetsDir.js"></script>
    <script src="../src/js/html_tags/SkyLighting.js"></script>
    <script src="../src/js/html_tags/SkyAtmosphericParameters.js"></script>
    <script src="../src/js/html_tags/SkyLocation.js"></script>
    <script src="../src/js/html_tags/SkyTime.js"></script>
    <script src="../src/js/html_tags/SkyAurora.js"></script>
    <script src="../src/js/html_tags/SkyClouds.js"></script>

    <!-- LUT Libraries -->
    <script src="../src/js/lut_libraries/AtmosphericLUTLibrary.js"></script>
    <script src="../src/js/lut_libraries/StellarLUTLibrary.js"></script>
    <script src="../src/js/lut_libraries/CloudLUTLibrary.js"></script>

    <!-- Renderers -->
    <script src="../src/js/renderers/FogRenderer.js"></script>
    <script src="../src/js/renderers/AtmosphereRenderer.js"></script>
    <script src="../src/js/renderers/SunRenderer.js"></script>
    <script src="../src/js/renderers/MoonRenderer.js"></script>
    <script src="../src/js/renderers/MeteringSurveyRenderer.js"></script>

    <!--Players -->
    <script src="../src/js/components/LightingManager.js"></script>
    <script src="../src/js/components/AssetManager.js"></script>
    <script src="../src/js/components/SkyDirector.js"></script>

    <!-- A-Frame Hooks -->
    <script src="../src/js/primitives/a-starry-sky.js"></script>
    <script src="../src/js/components/starry-sky-wrapper.js"></script>

  <!--Scene Scripts-->
  </head>
  <body>
    <a-scene physics light="defaultLightsEnabled: false" shadow="type: pcfsoft">
      <a-entity fps-counter></a-entity>

      <!-- Sky Setup -->
      <a-starry-sky web-worker-src="../dist/wasm/starry-sky-web-worker.js">
          <sky-time>
             <sky-date>2022-08-30 12:00:00</sky-date>
             <sky-speed>400</sky-speed>
          </sky-time>
          <sky-atmospheric-parameters>
            <!-- Notice that Mars scatters red light more -->
            <sky-rayleigh-beta>
              <sky-parameters-color-red>19.918E-3</sky-parameters-color-red>
              <sky-parameters-color-green>13.577E-3</sky-parameters-color-green>
              <sky-parameters-color-blue>5.57E-3</sky-parameters-color-blue>
            </sky-rayleigh-beta>
            <sky-rayleigh-scale-height>30.0</sky-rayleigh-scale-height>

            <!-- A few modifications to mie also help -->
            <sky-mie-beta>
              <sky-parameters-color-red>10.0E-3</sky-parameters-color-red>
              <sky-parameters-color-green>10.0E-3</sky-parameters-color-green>
              <sky-parameters-color-blue>10.0E-3</sky-parameters-color-blue>
            </sky-mie-beta>
            <sky-mie-scale-height>2.0</sky-mie-scale-height>

            <!-- Make sure to disable the ozone -->
            <sky-ozone-percent-of-rayleigh>0.0</sky-ozone-percent-of-rayleigh>

            <!-- Well, in our case, Mars... -->
            <sky-radius-of-earth>3389.5</sky-radius-of-earth>
            <sky-atmosphere-height>10.8</sky-atmosphere-height>

            <!-- The sun is smaller and the moon we can eliminate entirely -->
            <sky-sun-angular-diameter>0.35</sky-sun-angular-diameter>
            <sky-moon-angular-diameter>0.0</sky-moon-angular-diameter>
            <sky-sun-intensity>590.0</sky-sun-intensity>
            <sky-moon-intensity>0.0</sky-moon-intensity>
          </sky-atmospheric-parameters>
      </a-starry-sky>

      <a-assets>
        <a-asset-item id="low-poly-desert" src="./assets/3d-models/low-poly-desert.glb" ></a-asset-item>
      </a-assets>

      <a-entity id="rig" movement-controls position="25 0.0 25">
        <a-entity camera look-controls wasd-controls="acceleration: 100"></a-entity>
      </a-entity>

      <!-- Scene Setup-->
      <a-entity gltf-model="#low-poly-desert" position="0 0.0 0" shadow="cast: false"></a-entity>
    </a-scene>
  </body>
</html>
