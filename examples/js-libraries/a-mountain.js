!function(t){function a(r){if(e[r])return e[r].exports;var n=e[r]={exports:{},id:r,loaded:!1};return t[r].call(n.exports,n,n.exports,a),n.loaded=!0,n.exports}var e={};return a.m=t,a.c=e,a.p="",a(0)}([function(t,a,e){function r(t,a){for(var e=t*a,r=new Uint8Array(e),n=new o,i=1,l=100*Math.random(),u=0;u<4;u++){for(var d=0;d<e;d++){var s=d%t,h=~~(d/t);r[d]+=Math.abs(n.noise(s/i,h/i,l)*i*1.75)}i*=5}return r}function n(t,a,e,r,n,o){var i=new THREE.Vector3(o.x,o.y,o.z);i.normalize();var l=document.createElement("canvas");l.width=a,l.height=e;var u=l.getContext("2d");u.fillStyle="#000",u.fillRect(0,0,a,e);for(var d,s=u.getImageData(0,0,l.width,l.height),h=s.data,c=256*r.r,m=256*r.g,p=256*r.b,w=256*n.r,f=256*n.g,E=256*n.b,g=new THREE.Vector3(0,0,0),v=0,T=0,R=h.length;v<R;v+=4,T++)g.x=t[T-2]-t[T+2],g.y=2,g.z=t[T-2*a]-t[T+2*a],g.normalize(),d=g.dot(i),h[v]=(c+d*w)*(.5+.007*t[T]),h[v+1]=(m+d*E)*(.5+.007*t[T]),h[v+2]=(p+d*f)*(.5+.007*t[T]);u.putImageData(s,0,0);var x=document.createElement("canvas");x.width=4*a,x.height=4*e,u=x.getContext("2d"),u.scale(4,4),u.drawImage(l,0,0),s=u.getImageData(0,0,x.width,x.height),h=s.data;for(var v=0,R=h.length;v<R;v+=4){var C=~~(5*Math.random());h[v]+=C,h[v+1]+=C,h[v+2]+=C}return u.putImageData(s,0,0),x}var o=e(1);AFRAME.registerComponent("mountain",{schema:{color:{"default":"rgb(92, 32, 0)"},shadowColor:{"default":"rgb(128, 96, 96)"},sunPosition:{type:"vec3","default":{x:1,y:1,z:1}},worldDepth:{"default":256},worldWidth:{"default":256}},update:function(){var t=this.data,a=t.worldDepth,e=t.worldWidth,o=r(e,a),i=n(o,e,a,new THREE.Color(t.color),new THREE.Color(t.shadowColor),t.sunPosition),l=new THREE.CanvasTexture(i);l.wrapS=THREE.ClampToEdgeWrapping,l.wrapT=THREE.ClampToEdgeWrapping;var u=new THREE.PlaneBufferGeometry(7500,7500,e-1,a-1);u.rotateX(-Math.PI/2);for(var d=u.attributes.position.array,s=0,h=0,c=d.length;s<c;s++,h+=3)d[h+1]=10*o[s];u.translate(0,-1*(10*o[e/2+a/2*e]+500),0);var m=(new THREE.MeshBasicMaterial({map:l}),new THREE.Mesh(u,new THREE.MeshBasicMaterial({map:l})));this.el.setObject3D("mesh",m)}}),AFRAME.registerPrimitive("a-mountain",{defaultComponents:{mountain:{}},mappings:{color:"mountain.color","shadow-color":"mountain.shadowColor","sun-position":"mountain.sunPosition","world-depth":"mountain.worldDepth","world-width":"mountain.worldWidth"}})},function(t,a){var e=function(){function t(t){return t*t*t*(t*(6*t-15)+10)}function a(t,a,e){return a+t*(e-a)}function e(t,a,e,r){var n=15&t,o=n<8?a:e,i=n<4?e:12==n||14==n?a:r;return(0==(1&n)?o:-o)+(0==(2&n)?i:-i)}for(var r=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],n=0;n<256;n++)r[256+n]=r[n];return{noise:function(n,o,i){var l=~~n,u=~~o,d=~~i,s=255&l,h=255&u,c=255&d;n-=l,o-=u,i-=d;var m=n-1,p=o-1,w=i-1,f=t(n),E=t(o),g=t(i),v=r[s]+h,T=r[v]+c,R=r[v+1]+c,x=r[s+1]+h,C=r[x]+c,H=r[x+1]+c;return a(g,a(E,a(f,e(r[T],n,o,i),e(r[C],m,o,i)),a(f,e(r[R],n,p,i),e(r[H],m,p,i))),a(E,a(f,e(r[T+1],n,o,w),e(r[C+1],m,o,i-1)),a(f,e(r[R+1],n,p,w),e(r[H+1],m,p,w))))}}};t.exports=e}]);
