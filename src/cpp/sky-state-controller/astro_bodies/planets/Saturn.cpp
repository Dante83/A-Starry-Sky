#include "../../world_state/AstroTime.h"
#include "../../Constants.h"
#include "../OtherPlanet.h"
#include "Earth.h"
#include "Saturn.h"
#include <cmath>

//
//Constructor
//
Saturn::Saturn(AstroTime* astroTimeRef) : OtherPlanet(astroTimeRef){
  //
  //Default constructor
  //
};

//From page 286 of Meeus
void Saturn::updateMagnitudeOfPlanet(){
  //We ignore the abberation effects when calculating this value
  double i = check4GreaterThan360(28.075216 - 0.012998 * astroTime->julianCentury + 0.000004 * astroTime->julianCentury * astroTime->julianCentury) * DEG_2_RAD;
  double omega = check4GreaterThan360(169.508470 + 1.394681 * astroTime->julianCentury + 0.000412 * astroTime->julianCentury * astroTime->julianCentury) * DEG_2_RAD;
  double x = heliocentric_x - earth->heliocentric_x;
  double y = heliocentric_y - earth->heliocentric_y;
  double z = heliocentric_z - earth->heliocentric_z;
  double lambda = atan2(y, x);
  double sin_lambda_minus_omega = sin(lambda - omega);
  double beta = atan2(z, sqrt(x * x + y * y));
  double sin_i = sin(i);
  double cos_i = cos(i);
  double sin_beta = sin(beta);
  double cos_beta = cos(beta);
  double sinB = sin_i * cos_beta * sin_lambda_minus_omega - cos_i * sin_beta;
  double cos_eclipticalLatitude = cos(eclipticalLatitude);
  double u1 = atan2(sin_i * sin(eclipticalLatitude) + cos_i * cos_eclipticalLatitude * sin(eclipticalLongitude - omega), (cos_eclipticalLatitude * cos(eclipticalLongitude - omega)));
  double u2 = atan2(sin_i * sin_beta + cos_i * cos_beta * sin_lambda_minus_omega, (cos_beta * cos(lambda - omega)));
  double deltaU = abs(u1 - u2);
  irradianceFromEarth = -8.88 + 5.0 * log(distanceFromSun * distanceFromEarth) + 0.44 * abs(deltaU) - 2.60 * abs(sinB) + 1.25 * sinB * sinB;
}

void Saturn::updateEclipticalLongitude(){
  const double L_0_A[90] = {87401354.025, 11107659.762, 1414150.957, 398379.389,
  350769.243, 206816.305, 79271.3, 23990.355, 16573.588, 14906.995, 15820.29,
  14609.559, 13160.301, 15053.543, 13005.299, 10725.067, 5863.206, 5227.757, 6126.317,
  5019.687, 4592.55, 4005.867, 2953.796, 3873.67, 2461.186, 3269.484, 1758.145,
  1640.172, 1391.327, 1580.648, 1123.498, 1017.275, 848.642, 1087.229, 956.757,
  789.205, 686.999, 654.484, 748.819, 633.982, 743.599, 852.677, 579.844, 624.883,
  529.874, 542.648, 474.277, 448.547, 546.365, 478.044, 354.988, 451.857, 347.422,
  343.481, 309.029, 322.189, 372.318, 321.562, 330.197, 249.142, 286.703, 220.225,
  277.774, 204.52, 207.645, 208.65, 182.459, 226.601, 207.666, 173.914, 184.698,
  183.509, 146.074, 164.541, 147.544, 139.69, 131.292, 117.326, 149.302, 122.371,
  113.737, 102.689, 118.169, 109.287, 110.4, 124.98, 89.916, 103.968, 112.43,
  106.578};
  const double L_0_B[90] = {0.0, 3.96205090159, 4.58581516874, 0.52112032699, 3.30329907896,
  0.24658372002, 3.84007056878, 4.66976924553, 0.43719228296, 5.76903183869, 0.93809155235,
  1.56518472, 4.44891291899, 2.71669915667, 5.98119023644, 3.12939523827, 0.23656938524,
  4.20783365759, 1.76328667907, 3.17787728405, 0.61977744975, 2.24479718502, 0.98280366998,
  3.22283226966, 2.03163875071, 0.77492638211, 3.2658010994, 5.5050445305, 4.02333150505,
  4.37265307169, 2.83726798446, 3.71700135395, 3.1915017083, 4.1834325756, 0.50744342622,
  5.00745127508, 1.74714152638, 1.59889329033, 2.14396789786, 2.29887419204, 5.25277685028,
  3.42141279787, 3.09254750266, 0.9704808751, 4.44938991187, 1.51824981131, 5.47526482059,
  1.28991363969, 2.12677911914, 2.96486700885, 3.01280169452, 1.04437293342, 1.53923267387,
  0.24603836481, 3.49491017725, 0.96136528867, 2.27822895353, 2.57185176731, 0.24721738903,
  1.47004230445, 2.37046001635, 4.20421716654, 0.40024010033, 6.01073368945, 0.48344140678,
  1.34533476508, 5.49122412646, 4.90997278296, 1.28298038875, 1.86305647242, 3.50349102817,
  0.97260974474, 6.23107926975, 0.44004693949, 1.53530368067, 4.29463428594, 4.06829024226,
  2.67913173095, 5.73592320434, 1.97585460706, 5.59421876022, 1.19754453191, 5.34072820318,
  3.43808188855, 0.16605133194, 6.27738701225, 5.80394843417, 2.19185625957, 1.10510750315,
  4.01153470635};
  const double L_0_C[90] = {0.0, 213.299095438, 7.1135470008, 206.185548437, 426.598190876,
  103.092774219, 220.412642439, 110.206321219, 419.484643875, 316.391869657, 632.783739313,
  3.9321532631, 14.2270940016, 639.897286314, 11.0457002639, 202.253395174, 529.690965095,
  3.1813937377, 277.034993741, 433.711737877, 199.072001436, 63.7358983034, 95.9792272178,
  138.517496871, 735.876513532, 949.17560897, 522.577418094, 846.082834751, 323.505416657,
  309.278322656, 415.552490612, 227.52618944, 209.366942175, 2.4476805548, 1265.56747863,
  0.9632078465, 1052.26838319, 0.0481841098, 853.196381752, 412.371096874, 224.344795702,
  175.1660598, 74.7815985673, 210.1177017, 117.31986822, 9.5612275556, 742.990060533,
  127.471796607, 350.3321196, 137.033024162, 838.96928775, 490.334089179, 340.770892045,
  0.5212648618, 216.480489176, 203.737867882, 217.231248701, 647.010833315, 1581.95934828,
  1368.66025285, 351.816592309, 200.768922466, 211.81462273, 265.989293477, 1162.47470441,
  625.670192312, 2.9207613068, 12.5301729722, 39.3568759152, 0.7507595254, 149.563197135,
  4.192785694, 195.139848173, 5.4166259714, 5.6290742925, 21.3406410024, 10.2949407385,
  1155.36115741, 52.6901980395, 4.665866446, 1059.38193019, 1685.0521225, 554.069987483,
  536.804512095, 1.4844727083, 1898.35121794, 114.138474483, 88.865680217, 191.20769491,
  956.289155971};

  double L0 = 0.0;
  for(int i = 0; i < 101; ++i){
    L0 += L_0_A[i] * cos(L_0_B[i] + L_0_C[i] * astroTime->julianCentury);
  }

  const double L_1_A[79] = {21329909521.7, 1297370.862, 564345.393, 93734.369,
  107674.962, 40244.455, 19941.774, 10511.678, 6416.106, 4848.994, 4056.892, 3768.635,
  3384.691, 3231.693, 3071.405, 1953.179, 1249.468, 921.35, 701.524, 649.591,
  627.498, 468.362, 440.442, 478.347, 408.8, 407.654, 343.72, 338.569, 336.129,
  331.895, 346.963, 289.484, 254.1, 230.497, 280.91, 192.275, 171.342, 167.11,
  136.321, 129.468, 127.864, 109.809, 93.929, 92.5, 97.503, 85.414, 83.544, 77.552,
  61.557, 61.894, 67.1, 56.935, 54.018, 54.588, 65.843, 49.36, 57.79, 44.445,
  46.462, 40.352, 37.766, 46.627, 45.601, 40.425, 37.318, 33.848, 37.468, 33.013,
  30.286, 35.096, 33.273, 31.908, 29.011, 28.659, 29.347, 28.266, 30.064, 31.444,
  26.507};
  const double L_1_B[79] = {0.0, 1.82834923978, 2.88499717272, 1.06311793502, 2.27769131009,
  2.04108104671, 1.2795439047, 2.7488034213, 0.38238295041, 2.43037610229, 2.92133209468,
  3.6496533078, 2.41694503459, 1.26149969158, 2.32739504783, 3.56378136497, 2.62810757084,
  1.96069472334, 4.43097553887, 6.17410622073, 6.1110981622, 4.61704486774, 6.0186116335,
  4.98809792152, 2.10122200324, 1.29967965754, 3.95819456535, 3.63538109408, 3.77170200605,
  2.86077271205, 2.24152661493, 2.73211009526, 0.54280472223, 1.64428691304, 5.74399466555,
  2.96534476762, 4.09606536666, 2.59746814308, 2.28588945465, 3.4486372972, 4.09556557491,
  6.16222822735, 3.48395603528, 3.94738565799, 4.72798517062, 1.21992749767, 3.11243528672,
  6.24420223771, 1.82806831206, 4.29399030957, 0.28960408801, 5.01850216663, 5.12526846805,
  0.28394184881, 5.64781011841, 1.44414937308, 2.47591802875, 2.70867717923, 1.17725360336,
  3.88835739308, 2.53385959344, 5.14898441386, 2.22651202659, 0.41248570335, 3.78007466606,
  3.21091304755, 0.63301847328, 0.30379634705, 2.84006878726, 6.08465483298, 4.640252073,
  4.38588051077, 3.38845528142, 2.0211899083, 5.41549054397, 2.74211823281, 6.18691482959,
  2.43486054228, 4.51149190693};
  const double L_1_C[79] = {0.0, 213.299095438, 7.1135470008, 426.598190876, 206.185548437,
  220.412642439, 103.092774219, 14.2270940016, 639.897286314, 419.484643875, 110.206321219,
  3.9321532631, 3.1813937377, 433.711737877, 199.072001436, 11.0457002639, 95.9792272178,
  227.52618944, 529.690965095, 202.253395174, 309.278322656, 63.7358983034, 853.196381752,
  522.577418094, 323.505416657, 209.366942175, 412.371096874, 316.391869657, 735.876513532,
  210.1177017, 632.783739313, 117.31986822, 647.010833315, 216.480489176, 2.4476805548,
  224.344795702, 846.082834751, 21.3406410024, 10.2949407385, 742.990060533, 217.231248701,
  415.552490612, 1052.26838319, 88.865680217, 838.96928775, 440.825284878, 625.670192312,
  302.164775655, 195.139848173, 127.471796607, 4.665866446, 137.033024162, 490.334089179,
  74.7815985673, 9.5612275556, 536.804512095, 191.958454436, 5.4166259714, 149.563197135,
  728.762966531, 12.5301729722, 515.463871093, 956.289155971, 269.921446741, 2.9207613068,
  1368.66025285, 422.666037613, 351.816592309, 203.004154699, 5.6290742925, 277.034993741,
  1155.36115741, 1059.38193019, 330.618963658, 1066.49547719, 265.989293477, 284.148540742,
  52.6901980395, 340.770892045};

  double L1 = 0.0;
  for(int i = 0; i < 88; ++i){
    L1 += L_1_A[i] * cos(L_1_B[i] + L_1_C[i] * astroTime->julianCentury);
  }

  const double L_2_A[63] = {116441.33, 91841.837, 36661.728, 15274.496, 10987.259,
  10629.83, 4265.404, 1215.447, 1142.595, 1061.494, 1020.102, 1044.759, 648.857,
  549.32, 456.767, 424.918, 273.782, 161.533, 129.502, 108.829, 100.917, 100.71,
  95.154, 81.962, 74.86, 82.667, 95.5, 64.191, 84.889, 66.442, 67.164, 53.849,
  52.073, 44.991, 45.297, 42.349, 32.05, 31.531, 31.16, 24.709, 26.54, 20.111,
  17.562, 17.423, 13.745, 12.239, 11.865, 15.992, 12.178, 11.013, 13.971, 10.983,
  9.95, 9.192, 9.424, 9.432, 10.125, 8.282, 7.182, 7.53, 6.339, 5.962, 7.482};
  const double L_2_B[63] = {1.17988132879, 0.0732519584, 0.0, 4.06493179167, 5.4447918831,
  0.25764306189, 1.04596041482, 2.91866579609, 4.63711665368, 5.68896768215, 0.6336845725,
  4.04202827818, 4.33990455509, 5.57301151406, 1.2689684848, 0.20908786519, 4.2885706119,
  1.38145587317, 1.56592444783, 3.89769392463, 0.89243113369, 4.89713543344, 5.62447011514,
  1.02414352999, 4.76187112999, 6.05014465562, 2.91469950689, 0.35066202401, 5.73495539065,
  0.48307559227, 0.45592762644, 2.71027004601, 4.77422682479, 5.69247085773, 1.66820818508,
  5.70774454577, 0.06977561095, 1.67269081492, 4.16289690897, 5.65552005153, 0.82957323703,
  5.94400958785, 4.90127107888, 1.62944882745, 3.76551606198, 4.71655885093, 0.12658169661,
  0.58010406176, 3.02991813349, 5.91647084481, 0.20726957441, 5.61246766042, 0.24994105562,
  4.15737094186, 3.21424196104, 0.46528491211, 4.98323117202, 2.1423724836, 5.40492160991,
  5.24653553801, 4.46236888166, 5.41494016179, 4.02606821044};
  const double L_2_C[63] = {7.1135470008, 213.299095438, 0.0, 206.185548437, 426.598190876,
  220.412642439, 14.2270940016, 103.092774219, 639.897286314, 433.711737877, 3.1813937377,
  199.072001436, 419.484643875, 3.9321532631, 110.206321219, 227.52618944, 95.9792272178,
  11.0457002639, 309.278322656, 853.196381752, 21.3406410024, 647.010833315, 412.371096874,
  117.31986822, 210.1177017, 216.480489176, 316.391869657, 323.505416657, 209.366942175,
  10.2949407385, 522.577418094, 529.690965095, 632.783739313, 440.825284878, 202.253395174,
  88.865680217, 63.7358983034, 302.164775655, 191.958454436, 735.876513532, 224.344795702,
  217.231248701, 625.670192312, 742.990060533, 195.139848173, 203.004154699, 234.63973644,
  515.463871093, 846.082834751, 536.804512095, 838.96928775, 728.762966531, 330.618963658,
  860.309928753, 1066.49547719, 956.289155971, 422.666037613, 269.921446741, 1052.26838319,
  429.779584614, 284.148540742, 149.563197135, 9.5612275556};

  double L2 = 0.0;
  for(int i = 0; i < 69; ++i){
    L2 += L_2_A[i] * cos(L_2_B[i] + L_2_C[i] * astroTime->julianCentury);
  }

  const double L_3_A[48] = {16038.732, 4254.737, 1906.379, 1464.959, 1162.062,
  1044.765, 236.068, 237.009, 165.645, 131.328, 150.882, 61.607, 63.899, 40.405,
  40.222, 38.807, 26.949, 25.017, 32.692, 18.051, 17.831, 15.894, 15.768, 18.212,
  18.497, 12.927, 17.889, 11.44, 10.554, 10.432, 8.655, 7.523, 5.871, 5.349, 4.986,
  6.3, 3.608, 2.933, 2.572, 2.479, 2.175, 2.368, 2.705, 1.981, 2.151, 2.05, 2.129,
  1.804};
  const double L_3_B[48] = {5.73945573267, 4.58877599687, 4.7607084357, 5.91328884284,
  5.61974313217, 3.57813061587, 3.85849798708, 5.76820709729, 5.11642167451, 4.74306126145,
  2.72695802283, 4.74260728276, 0.08672623762, 5.47280316518, 5.96343977224, 5.83309187434,
  3.00877360899, 0.98675576491, 3.14159265359, 1.021817946, 3.32039911376, 3.89729495217,
  5.61263410328, 4.96397771331, 1.9253436571, 1.17950837478, 4.20422746039, 5.57587131751,
  5.92710883673, 3.95667199114, 3.39231823414, 4.87915941795, 1.0570339306, 4.63664712061,
  0.17277280741, 2.25329355289, 2.30889061812, 2.21148312356, 0.41973213333, 4.94903388247,
  3.16635787015, 4.75945968289, 0.65007424536, 4.38259974938, 1.35777052319, 1.03766221834,
  3.34889649076, 3.08896387579};
  const double L_3_C[48] = {7.1135470008, 213.299095438, 220.412642439, 206.185548437,
  14.2270940016, 426.598190876, 433.711737877, 199.072001436, 3.1813937377, 227.52618944,
  639.897286314, 103.092774219, 419.484643875, 21.3406410024, 95.9792272178, 110.206321219,
  647.010833315, 3.9321532631, 0.0, 412.371096874, 309.278322656, 440.825284878,
  117.31986822, 10.2949407385, 853.196381752, 88.865680217, 216.480489176, 11.0457002639,
  191.958454436, 209.366942175, 302.164775655, 323.505416657, 210.1177017, 234.63973644,
  632.783739313, 522.577418094, 515.463871093, 860.309928753, 625.670192312, 224.344795702,
  202.253395174, 330.618963658, 529.690965095, 124.433415221, 405.257549874, 728.762966531,
  429.779584614, 654.124380316};

  double L3 = 0.0;
  for(int i = 0; i < 53; ++i){
    L3 += L_3_A[i] * cos(L_3_B[i] + L_3_C[i] * astroTime->julianCentury);
  }

  const double L_4_A[27] = {1661.877, 257.094, 236.328, 149.52, 109.412, 69.119,
  37.68, 39.678, 31.172, 15.026, 9.424, 5.131, 4.379, 5.391, 4.315, 3.215, 2.866,
  2.825, 2.584, 2.616, 1.872, 2.21, 1.772, 1.832, 1.759, 1.193, 0.765};
  const double L_4_B[27] = {3.99824447634, 2.98422287887, 3.9024884432, 2.73191135434,
  1.51564560686, 1.74804093636, 1.23800346661, 2.04527339062, 3.01055217526, 0.83249780616,
  3.71267465225, 2.14278851183, 1.44314873951, 1.15849076251, 2.11844568875, 4.10085180982,
  3.036049512, 2.76965112625, 6.2804703528, 0.38576038218, 5.13517095425, 3.77003162591,
  5.18511152518, 2.8429204789, 2.26487572601, 1.54874757981, 4.76897987642};
  const double L_4_C[27] = {7.1135470008, 220.412642439, 14.2270940016, 213.299095438,
  206.185548437, 426.598190876, 199.072001436, 433.711737877, 227.52618944, 639.897286314,
  21.3406410024, 419.484643875, 95.9792272178, 647.010833315, 440.825284878, 110.206321219,
  88.865680217, 412.371096874, 853.196381752, 103.092774219, 309.278322656, 117.31986822,
  302.164775655, 234.63973644, 216.480489176, 191.958454436, 210.1177017};

  double L4 = 0.0;
  for(int i = 0; i < 29; ++i){
    L4 += L_4_A[i] * cos(L_4_B[i] + L_4_C[i] * astroTime->julianCentury);
  }

  const double L_5_A[12] = {123.607, 34.176, 27.539, 5.763, 5.284, 3.65, 3.061,
  2.865, 1.499, 1.262, 0.756, 0.759};
  const double L_5_B[12] = {2.25923420203, 2.16278773143, 1.19822164604, 1.21171444884,
  0.23520891295, 6.20014021207, 2.96839870592, 4.29470838129, 6.21044685389, 5.25209851911,
  6.17670364645, 0.69127092329};
  const double L_5_C[12] = {7.1135470008, 14.2270940016, 220.412642439, 227.52618944,
  433.711737877, 426.598190876, 199.072001436, 206.185548437, 213.299095438, 639.897286314,
  191.958454436, 302.164775655};

  double L5 = 0.0;
  for(int i = 0; i < 13; ++i){
    L5 += L_5_A[i] * cos(L_5_B[i] + L_5_C[i] * astroTime->julianCentury);
  }

  double julianCenturyMultiple = 1.0;
  double LValues[5] = {L0, L1, L2, L3, L4};
  eclipticalLongitude = 0.0;
  for(int i = 0; i < 5; ++i){
    eclipticalLongitude += LValues[i] * julianCenturyMultiple;
    julianCenturyMultiple *= astroTime->julianCentury;
  }
  eclipticalLongitude = eclipticalLongitude / 1.0e-8;
}

void Saturn::updateEclipticalLatitude(){
  const double B_0_A[34] = {4330678.039, 240348.302, 84745.939, 30863.357, 34116.062,
  14734.07, 9916.667, 6993.564, 4807.588, 4788.392, 3432.125, 1506.129, 1060.298,
  969.071, 942.05, 707.645, 552.314, 399.674, 316.063, 319.38, 284.495, 314.224,
  236.441, 215.354, 208.523, 178.958, 207.214, 139.14, 134.884, 140.585, 121.669,
  139.24, 115.525, 114.218};
  const double B_0_B[34] = {3.60284428399, 2.85238489373, 0.0, 3.48441504555, 0.57297307557,
  2.11846596715, 5.79003188904, 4.7360468972, 5.43305312061, 4.96512926584, 2.732557466,
  6.01304519391, 5.6309929646, 5.20434966293, 1.39646688872, 3.80302289005, 5.13149119536,
  3.35891409671, 1.99716693551, 3.62571687438, 4.88648507126, 0.46510248959, 2.13887684631,
  5.9498256102, 2.12003937634, 2.95361337281, 0.73021353207, 1.99821987827, 5.24501026174,
  0.64417933116, 3.11537142395, 4.59535592976, 3.1089202092, 0.96262037933};
  const double B_0_C[34] = {213.299095438, 426.598190876, 0.0, 220.412642439, 206.185548437,
  639.897286314, 419.484643875, 7.1135470008, 316.391869657, 110.206321219, 433.711737877,
  103.092774219, 529.690965095, 632.783739313, 853.196381752, 323.505416657, 202.253395174,
  227.52618944, 647.010833315, 209.366942175, 224.344795702, 217.231248701, 11.0457002639,
  846.082834751, 415.552490612, 63.7358983034, 199.072001436, 735.876513532, 742.990060533,
  490.334089179, 522.577418094, 14.2270940016, 216.480489176, 210.1177017};

  double B0 = 0.0;
  for(int i = 0; i < 38; ++i){
    B0 += B_0_A[i] * cos(B_0_B[i] + B_0_C[i] * astroTime->julianCentury);
  }

  const double B_1_A[32] = {198927.992, 36947.916, 17966.989, 10919.721, 13320.265,
  3243.428, 2900.519, 1584.712, 1580.666, 700.659, 310.902, 301.237, 303.761,
  259.878, 252.673, 182.664, 157.532, 108.184, 88.301, 86.875, 93.226, 76.217,
  67.406, 69.585, 53.865, 48.657, 38.289, 30.566, 27.841, 32.708, 18.822, 19.503};
  const double B_1_B[32] = {4.93901017903, 3.14159265359, 0.5197943111, 1.79463271368,
  2.26481519893, 1.21094033148, 6.17033461979, 0.9341639713, 3.08171717435, 0.20545152078,
  4.38351712708, 1.66219956459, 5.46322830151, 3.93026240568, 0.9002092521, 0.12142438148,
  2.42607457234, 1.39896246207, 2.17503185037, 2.91365320786, 2.4431495804, 2.73666477702,
  1.49053395808, 1.31682001912, 1.74961587267, 0.85586786255, 2.90107344056, 1.28845522495,
  4.74764197119, 2.2181845052, 5.62219514688, 0.67017561839};
  const double B_1_C[32] = {213.299095438, 0.0, 426.598190876, 220.412642439, 206.185548437,
  419.484643875, 639.897286314, 433.711737877, 7.1135470008, 316.391869657, 110.206321219,
  227.52618944, 853.196381752, 103.092774219, 632.783739313, 647.010833315, 199.072001436,
  529.690965095, 323.505416657, 14.2270940016, 217.231248701, 210.1177017, 209.366942175,
  216.480489176, 202.253395174, 440.825284878, 117.31986822, 412.371096874, 1066.49547719,
  224.344795702, 860.309928753, 846.082834751};

  double B1 = 0.0;
  for(int i = 0; i < 35; ++i){
    B1 += B_1_A[i] * cos(B_1_B[i] + B_1_C[i] * astroTime->julianCentury);
  }

  const double B_2_A[29] = {13884.264, 3075.713, 2081.666, 1452.574, 546.808, 391.398,
  319.74, 203.518, 220.164, 116.719, 67.605, 64.044, 55.518, 49.875, 38.984, 27.643,
  24.804, 21.498, 15.704, 19.538, 14.472, 12.29, 10.826, 11.875, 10.534, 7.971,
  9.046, 6.82, 5.266};
  const double B_2_B[29] = {0.08994998691, 3.9161093762, 0.09631968077, 5.48867576013,
  2.94585826799, 5.43939792344, 4.34820275048, 1.37396136744, 0.0, 6.24505924943,
  1.75135990376, 4.10904350356, 4.56815095513, 3.48944345784, 2.7993042852, 1.22439852303,
  4.48123972552, 5.38853499774, 4.28129850675, 5.81992746567, 1.71327951628, 4.06067197339,
  0.58425778734, 2.9567255894, 2.51484815706, 1.29072033406, 5.92757785737, 3.73629063516,
  3.17424271177};
  const double B_2_C[29] = {213.299095438, 206.185548437, 220.412642439, 426.598190876,
  419.484643875, 433.711737877, 639.897286314, 7.1135470008, 0.0, 227.52618944,
  316.391869657, 199.072001436, 647.010833315, 853.196381752, 632.783739313, 14.2270940016,
  210.1177017, 440.825284878, 217.231248701, 216.480489176, 110.206321219, 103.092774219,
  323.505416657, 412.371096874, 529.690965095, 117.31986822, 209.366942175, 860.309928753,
  202.253395174};

  double B2 = 0.0;
  for(int i = 0; i < 32; ++i){
    B2 += B_2_A[i] * cos(B_2_B[i] + B_2_C[i] * astroTime->julianCentury);
  }

  const double B_3_A[21] = {463.357, 487.242, 270.686, 277.451, 66.718, 65.617,
  69.846, 30.551, 29.704, 18.157, 17.504, 11.684, 6.048, 6.248, 6.42, 4.552, 4.995,
  4.166, 2.938, 2.894, 2.225};
  const double B_3_B[21] = {1.69194209337, 5.57827705588, 4.65445792593, 0.0, 3.66337287998,
  4.71263096227, 3.33236270677, 4.53651131935, 2.49374065388, 5.89401285772, 5.79120992263,
  2.74773493978, 5.80237729519, 1.60565634016, 3.63996599914, 6.21266119922, 3.21953122449,
  4.64321479214, 4.647670282, 4.02023147538, 0.67809668672};
  const double B_3_C[21] = {213.299095438, 206.185548437, 220.412642439, 0.0, 433.711737877,
  419.484643875, 426.598190876, 227.52618944, 639.897286314, 7.1135470008, 199.072001436,
  647.010833315, 14.2270940016, 853.196381752, 440.825284878, 210.1177017, 316.391869657,
  632.783739313, 412.371096874, 216.480489176, 103.092774219};

  double B3 = 0.0;
  for(int i = 0; i < 23; ++i){
    B3 += B_3_A[i] * cos(B_3_B[i] + B_3_C[i] * astroTime->julianCentury);
  }

  const double B_4_A[12] = {58.521, 27.023, 27.345, 8.709, 6.015, 6.059, 3.796,
  3.647, 2.054, 2.559, 1.867, 1.256};
  const double B_4_B[12] = {0.96404269672, 2.97511812746, 2.90816987834, 1.88638219079,
  2.81931276694, 0.21576562475, 1.19723799579, 1.71327650497, 0.66410894553, 3.14159265359,
  0.93578719925, 4.1317599278};
  const double B_4_C[12] = {206.185548437, 213.299095438, 220.412642439, 433.711737877,
  227.52618944, 419.484643875, 199.072001436, 426.598190876, 639.897286314, 0.0,
  647.010833315, 7.1135470008};

  double B4 = 0.0;
  for(int i = 0; i < 13; ++i){
    B4 += B_4_A[i] * cos(B_4_B[i] + B_4_C[i] * astroTime->julianCentury);
  }

  const double B_5_A[2] = {5.442, 1.966};
  const double B_5_B[2] = {2.61186488264, 1.16969532852};
  const double B_5_C[2] = {206.185548437, 220.412642439};

  double B5 = 0.0;
  for(int i = 0; i < 2; ++i){
    B5 += B_5_A[i] * cos(B_5_B[i] + B_5_C[i] * astroTime->julianCentury);
  }

  double julianCenturyMultiple = 1.0;
  double BValues[5] = {B0, B1, B2, B3, B4};
  eclipticalLatitude = 0.0;
  for(int i = 0; i < 5; ++i){
    eclipticalLatitude += BValues[i] * julianCenturyMultiple;
    julianCenturyMultiple *= astroTime->julianCentury;
  }
  eclipticalLatitude = eclipticalLatitude / 1.0e-8;
}

void Saturn::updateRadiusVector(){
  const double R_0_A[44] = {955758135.486, 52921382.865, 1873679.867, 1464663.929,
  821891.141, 547506.923, 371684.65, 361778.765, 140617.506, 108974.848, 69006.962,
  61053.367, 48913.294, 34143.772, 32401.773, 20936.596, 20839.3, 20746.751, 15298.404,
  14296.484, 11993.338, 11380.257, 12884.624, 7752.664, 9796.004, 6465.823, 6770.608,
  5850.459, 5307.42, 4695.487, 4044.055, 3688.237, 3376.576, 2885.428, 2975.955,
  3419.618, 3460.944, 3400.702, 2507.656, 2448.261, 2406.134, 2881.1, 2173.933,
  2024.755};
  const double R_0_B[44] = {0.0, 2.39226219573, 5.2354960466, 1.64763042902, 5.93520042303,
  5.0153261898, 2.27114821115, 3.13904301847, 5.70406606781, 3.29313390175, 5.94099540992,
  0.94037691801, 1.55733638681, 0.19519102597, 5.47084567016, 0.46349251129, 1.52102476129,
  5.33255457763, 3.0594381494, 2.60433479142, 5.98050967385, 1.7310542704, 1.64890652873,
  5.85190720634, 5.20477537945, 0.17732249942, 3.00432308205, 1.45520063003, 0.597422002,
  2.14913875148, 1.64006628713, 0.78017261355, 3.69526804193, 1.38764476428, 5.6846913175,
  4.94550542171, 1.8508869805, 0.55385265588, 3.53854849756, 6.18411000897, 2.96557066697,
  0.17962517668, 0.01504273441, 5.05404443168};
  const double R_0_C[44] = {0.0, 213.299095438, 206.185548437, 426.598190876, 316.391869657,
  103.092774219, 220.412642439, 7.1135470008, 632.783739313, 110.206321219, 419.484643875,
  639.897286314, 202.253395174, 277.034993741, 949.17560897, 735.876513532, 433.711737877,
  199.072001436, 529.690965095, 323.505416657, 846.082834751, 522.577418094, 138.517496871,
  95.9792272178, 1265.56747863, 1052.26838319, 14.2270940016, 415.552490612, 63.7358983034,
  227.52618944, 209.366942175, 412.371096874, 224.344795702, 838.96928775, 210.1177017,
  1581.95934828, 175.1660598, 350.3321196, 742.990060533, 1368.66025285, 117.31986822,
  853.196381752, 340.770892045, 11.0457002639};

  double R0 = 0.0;
  for(int i = 0; i < 50; ++i){
    R0 += R_0_A[i] * cos(R_0_B[i] + R_0_C[i] * astroTime->julianCentury);
  }

  const double R_1_A[38] = {6182981.34, 506577.242, 341394.029, 188491.195, 186261.486,
  143891.146, 49621.208, 20928.426, 19952.564, 18839.544, 12892.843, 13876.849,
  5396.842, 4869.289, 4247.221, 3252.331, 2856.066, 2909.54, 3081.41, 1987.731,
  1941.443, 1581.782, 1339.521, 1315.459, 1202.869, 1090.827, 954.3, 965.957,
  882.063, 874.31, 897.508, 784.828, 739.765, 612.93, 658.132, 649.59, 599.227,
  502.951};
  const double R_1_B[38] = {0.2584351148, 0.71114625261, 5.79635741658, 0.47215589652,
  3.14159265359, 1.40744822888, 6.0174427982, 5.09244947411, 1.1756060613, 1.60818334043,
  5.9432943302, 0.75884928866, 1.28853589711, 0.86797227054, 0.39294984732, 1.2585015433,
  2.1673128387, 4.60680719251, 3.43662543526, 2.45053765034, 6.02392296904, 1.29189091556,
  4.30812522038, 1.25295611814, 1.86661895487, 0.07529636493, 5.15171167674, 0.47988871608,
  1.88467410042, 1.40216274572, 0.98347755563, 3.06374185689, 1.38209924525, 3.03309390383,
  4.1437471502, 1.72473111863, 2.54946247931, 2.12941646895};
  const double R_1_C[38] = {213.299095438, 206.185548437, 426.598190876, 220.412642439,
  0.0, 7.1135470008, 103.092774219, 639.897286314, 419.484643875, 110.206321219,
  433.711737877, 199.072001436, 14.2270940016, 323.505416657, 227.52618944, 95.9792272178,
  735.876513532, 202.253395174, 522.577418094, 412.371096874, 209.366942175, 210.1177017,
  853.196381752, 117.31986822, 316.391869657, 216.480489176, 647.010833315, 632.783739313,
  1052.26838319, 224.344795702, 529.690965095, 838.96928775, 625.670192312, 63.7358983034,
  309.278322656, 742.990060533, 217.231248701, 3.9321532631};

  double R1 = 0.0;
  for(int i = 0; i < 43; ++i){
    R1 += R_1_A[i] * cos(R_1_B[i] + R_1_C[i] * astroTime->julianCentury);
  }

  const double R_2_A[32] = {436902.572, 71922.498, 49766.872, 43220.783, 29645.766,
  4141.687, 4720.822, 3789.321, 2963.981, 2556.403, 2208.473, 2187.311, 1956.779,
  2326.777, 923.829, 705.974, 545.943, 373.763, 360.843, 356.448, 390.607, 431.231,
  325.474, 404.424, 204.458, 206.684, 177.973, 179.903, 153.635, 147.816, 123.132,
  132.767};
  const double R_2_B[32] = {4.78671677509, 2.5007006993, 4.97167777235, 3.86941044212,
  5.96309886479, 4.10673009419, 2.47524028389, 3.0977118974, 1.37198670946, 2.85066948131,
  6.27590108662, 5.8554501714, 4.92451269861, 0.0, 5.4638968891, 2.97065900638,
  4.12843012325, 5.8341214698, 3.27730304283, 3.19046275776, 4.48122593284, 5.17807636127,
  2.26775488379, 4.17313476718, 0.08803952503, 4.02119282093, 4.09718163123, 3.59725930296,
  3.13514267989, 0.13561171385, 4.188082239, 2.59540724138};
  const double R_2_C[32] = {213.299095438, 206.185548437, 220.412642439, 426.598190876,
  7.1135470008, 433.711737877, 199.072001436, 639.897286314, 103.092774219, 419.484643875,
  110.206321219, 14.2270940016, 227.52618944, 0.0, 323.505416657, 95.9792272178,
  412.371096874, 117.31986822, 647.010833315, 210.1177017, 216.480489176, 522.577418094,
  853.196381752, 209.366942175, 202.253395174, 735.876513532, 440.825284878, 632.783739313,
  625.670192312, 302.164775655, 88.865680217, 191.958454436};

  double R2 = 0.0;
  for(int i = 0; i < 36; ++i){
    R2 += R_2_A[i] * cos(R_2_B[i] + R_2_C[i] * astroTime->julianCentury);
  }

  const double R_3_A[28] = {20315.239, 8923.679, 6908.768, 4087.056, 3878.848,
  1070.754, 907.379, 605.936, 596.411, 483.108, 393.213, 229.396, 187.917, 149.326,
  121.613, 101.3, 102.03, 92.737, 72.411, 84.197, 61.913, 45.22, 49.426, 54.819,
  40.466, 38.104, 32.001, 40.737};
  const double R_3_B[28] = {3.02186068237, 3.19144467228, 4.35175288182, 4.22398596149,
  2.01051759517, 4.20372656114, 2.28356519128, 3.17456913264, 4.13395467306, 1.17313249713,
  0.0, 4.69783424016, 4.5908926492, 3.20334759568, 3.76751430846, 5.81716272185,
  4.70997918436, 1.43601934858, 4.15100432048, 2.63457296718, 2.31131212952, 4.37634609863,
  2.38844043734, 0.30627159494, 1.83906916098, 5.93442433914, 4.01244131364, 0.68516563011};
  const double R_3_C[28] = {213.299095438, 220.412642439, 206.185548437, 7.1135470008,
  426.598190876, 199.072001436, 433.711737877, 227.52618944, 14.2270940016, 639.897286314,
  0.0, 419.484643875, 110.206321219, 103.092774219, 323.505416657, 412.371096874,
  95.9792272178, 647.010833315, 117.31986822, 216.480489176, 440.825284878, 191.958454436,
  209.366942175, 853.196381752, 302.164775655, 88.865680217, 21.3406410024, 522.577418094};

  double R3 = 0.0;
  for(int i = 0; i < 31; ++i){
    R3 += R_3_A[i] * cos(R_3_B[i] + R_3_C[i] * astroTime->julianCentury);
  }

  const double R_4_A[23] = {1202.117, 707.794, 516.224, 426.107, 267.495, 170.055,
  144.813, 150.056, 121.067, 47.503, 15.651, 16.364, 18.973, 14.49, 12.31, 14.688,
  10.893, 11.348, 9.21, 9.007, 8.089, 8.668, 7.794};
  const double R_4_B[23] = {1.41498340225, 1.16151449537, 6.2404910535, 2.46891791825,
  0.18644716875, 5.96000580678, 1.44265291294, 0.47968186381, 2.40476128629, 5.56874777537,
  2.89076603229, 0.53928792415, 5.8551475302, 1.31356947305, 2.10618416544, 0.29685965949,
  2.45288604864, 0.17490312278, 2.30108004686, 1.55461797818, 3.62570131736, 0.69662054025,
  4.50477684881};
  const double R_4_C[23] = {220.412642439, 213.299095438, 206.185548437, 7.1135470008,
  426.598190876, 199.072001436, 227.52618944, 433.711737877, 14.2270940016, 639.897286314,
  110.206321219, 440.825284878, 647.010833315, 412.371096874, 323.505416657, 419.484643875,
  117.31986822, 95.9792272178, 21.3406410024, 88.865680217, 302.164775655, 216.480489176,
  853.196381752};

  double R4 = 0.0;
  for(int i = 0; i < 25; ++i){
    R4 += R_4_A[i] * cos(R_4_B[i] + R_4_C[i] * astroTime->julianCentury);
  }

  const double R_5_A[18] = {128.668, 32.196, 26.737, 19.837, 19.994, 13.627, 13.706,
  14.068, 7.324, 4.916, 2.985, 2.675, 3.42, 3.171, 2.885, 2.173, 1.873, 2.055};
  const double R_5_B[18] = {5.91279864289, 0.69558284384, 5.91270395039, 0.6739685296,
  4.95031713518, 1.47747814594, 4.59824754628, 2.63892426573, 4.64667642371, 3.63019930267,
  4.64378755577, 0.51742057647, 4.91489841099, 4.10118061147, 3.24108476164, 5.39877301813,
  3.22101902976, 3.60842101774};
  const double R_5_C[18] = {220.412642439, 7.1135470008, 227.52618944, 14.2270940016,
  433.711737877, 199.072001436, 426.598190876, 206.185548437, 213.299095438, 639.897286314,
  191.958454436, 323.505416657, 440.825284878, 647.010833315, 419.484643875, 302.164775655,
  95.9792272178, 88.865680217};

  double R5 = 0.0;
  for(int i = 0; i < 19; ++i){
    R5 += R_5_A[i] * cos(R_5_B[i] + R_5_C[i] * astroTime->julianCentury);
  }

  double julianCenturyMultiple = 1.0;
  double RValues[5] = {R0, R1, R2, R3, R4};
  radiusVector = 0.0;
  for(int i = 0; i < 5; ++i){
    radiusVector += RValues[i] * julianCenturyMultiple;
    julianCenturyMultiple *= astroTime->julianCentury;
  }
  radiusVector = radiusVector / 1.0e-8;
}
